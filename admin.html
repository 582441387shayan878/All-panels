<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>ğŸ® Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&display=swap');
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Orbitron',sans-serif;
      background:linear-gradient(135deg,#0f0f23 0%,#1a1a2e 50%,#16213e 100%);
      color:#e0e0e0;min-height:100vh;padding:20px;direction:rtl;position:relative;overflow-x:hidden;
    }
    body::before{
      content:'';position:absolute;top:0;left:0;width:100%;height:100%;
      background:radial-gradient(circle at 20% 80%,rgba(0,255,238,.1) 0%,transparent 50%),
                 radial-gradient(circle at 80% 20%,rgba(255,0,255,.1) 0%,transparent 50%);
      z-index:-1;
    }
    .container{max-width:1200px;margin:0 auto;padding:20px}
    header{text-align:center;margin-bottom:40px;position:relative}
    h1{
      font-size:3rem;font-weight:700;margin-bottom:10px;
      background:linear-gradient(90deg,#00ffcc,#0099ff,#cc00ff);
      -webkit-background-clip:text;background-clip:text;color:transparent;
      text-shadow:0 0 20px rgba(0,255,238,.5);animation:glow 2s infinite alternate
    }
    @keyframes glow{from{filter:drop-shadow(0 0 5px rgba(0,255,238,.7))}
    to{filter:drop-shadow(0 0 15px rgba(0,255,238,.9))}}
    .subtitle{font-size:1.2rem;color:#a0a0a0;margin-bottom:30px}
    .admin-panel{display:grid;grid-template-columns:1fr 1fr;gap:30px;margin-bottom:40px}
    @media (max-width:968px){.admin-panel{grid-template-columns:1fr}}
    .card{
      background:rgba(30,30,50,.7);backdrop-filter:blur(10px);border-radius:15px;
      border:1px solid rgba(100,100,255,.2);padding:25px;box-shadow:0 8px 32px rgba(0,0,0,.3);
      transition:transform .3s,box-shadow .3s;
    }
    .card:hover{transform:translateY(-5px);box-shadow:0 12px 40px rgba(0,100,255,.2)}
    .card-title{font-size:1.5rem;margin-bottom:20px;color:#00ffcc;display:flex;align-items:center;gap:10px}
    .form-group{margin-bottom:20px}
    label{display:block;margin-bottom:8px;font-weight:500;color:#b0b0b0}
    input,textarea{
      width:100%;padding:12px 15px;border-radius:8px;border:1px solid rgba(100,100,255,.3);
      background:rgba(20,20,40,.6);color:#e0e0e0;font-family:'Orbitron',sans-serif;
      transition:border-color .3s,box-shadow .3s;
    }
    input:focus,textarea:focus{outline:none;border-color:#00ffcc;box-shadow:0 0 10px rgba(0,255,238,.3)}
    textarea{resize:vertical;min-height:100px}
    .btn{
      background:linear-gradient(90deg,#00ffcc,#0099ff);color:#0a0a1a;border:none;padding:12px 25px;border-radius:8px;
      font-weight:700;cursor:pointer;transition:all .3s;display:inline-flex;align-items:center;gap:8px;
      font-family:'Orbitron',sans-serif;font-size:1rem;
    }
    .btn:hover{transform:translateY(-2px);box-shadow:0 5px 15px rgba(0,255,238,.4)}
    .btn:active{transform:translateY(0)}
    .btn-secondary{background:rgba(100,100,255,.2);color:#e0e0e0}
    .btn-danger{background:linear-gradient(90deg,#ff416c,#ff4b2b);color:#fff}
    .panel-list{margin-top:40px}
    .panel-item{
      background:rgba(30,30,50,.7);backdrop-filter:blur(10px);padding:20px;margin-bottom:20px;border-radius:15px;
      border:1px solid rgba(100,100,255,.2);box-shadow:0 8px 32px rgba(0,0,0,.3);transition:transform .3s,box-shadow .3s;
    }
    .panel-item:hover{transform:translateY(-3px);box-shadow:0 10px 35px rgba(0,100,255,.2)}
    .panel-item h3{margin:0 0 10px;color:#00ffcc;font-size:1.4rem}
    .panel-item p{margin:5px 0;color:#b0b0b0;line-height:1.5}
    .panel-item .file-info{color:#0099ff;font-weight:500;margin:10px 0}
    .panel-actions{display:flex;gap:10px;margin-top:15px;flex-wrap:wrap}
    .password-strength{height:5px;margin-top:5px;border-radius:5px;background:#333;overflow:hidden}
    .password-strength-meter{height:100%;width:0;transition:width .3s,background-color .3s}
    .weak{background:#ff4b2b;width:33%}.medium{background:#ffb347;width:66%}.strong{background:#00ff88;width:100%}
    .notification{
      position:fixed;top:20px;right:20px;padding:15px 20px;border-radius:8px;color:#fff;font-weight:500;z-index:1000;
      transform:translateX(120%);transition:transform .3s ease-out
    }
    .notification.show{transform:translateX(0)}
    .notification.success{background:linear-gradient(90deg,#00ff88,#00cc66)}
    .notification.error{background:linear-gradient(90deg,#ff4b2b,#ff416c)}
    footer{text-align:center;margin-top:50px;padding-top:20px;border-top:1px solid rgba(100,100,255,.2);color:#808080;font-size:.9rem}
    /* Ø±ÛŒØ²ØªØ± */
    .hint{font-size:.85rem;color:#a0a0a0;margin-top:-10px}
    .row{display:flex;gap:12px}
    .row > *{flex:1}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„Ú©Ø³ÛŒÙˆÙ†</h1>
      <p class="subtitle">Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ù†Ù„â€ŒÙ‡Ø§ Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ</p>
    </header>

    <div class="admin-panel">
      <!-- Ø§ÙØ²ÙˆØ¯Ù† Ù¾Ù†Ù„ -->
      <div class="card">
        <h2 class="card-title"><span>â•</span> Ø§ÙØ²ÙˆØ¯Ù† Ù¾Ù†Ù„ Ø¬Ø¯ÛŒØ¯</h2>
        <div class="form-group">
          <label for="title">Ø¹Ù†ÙˆØ§Ù† Ù¾Ù†Ù„:</label>
          <input type="text" id="title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ù¾Ù†Ù„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
        </div>
        <div class="form-group">
          <label for="description">ØªÙˆØ¶ÛŒØ­Ø§Øª:</label>
          <textarea id="description" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ù¾Ù†Ù„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯"></textarea>
        </div>
        <div class="form-group">
          <label for="file">Ù†Ø§Ù… ÙØ§ÛŒÙ„ (Ù…Ø«Ù„Ø§Ù‹ panel1.html):</label>
          <input type="text" id="file" placeholder="Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
        </div>
        <button class="btn" onclick="addPanel()">â• Ø§ÙØ²ÙˆØ¯Ù† Ù¾Ù†Ù„</button>
      </div>

      <!-- ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø¯Ù…ÛŒÙ† (Ù‡Ù…ÙˆÙ† Ø¨Ø®Ø´ Ø®ÙˆØ¯Øª) -->
      <div class="card">
        <h2 class="card-title"><span>ğŸ”’</span> ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø¯Ù…ÛŒÙ†</h2>
        <div class="form-group">
          <label for="currentPassword">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± ÙØ¹Ù„ÛŒ:</label>
          <input type="password" id="currentPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± ÙØ¹Ù„ÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
        </div>
        <div class="form-group">
          <label for="newPassword">Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¬Ø¯ÛŒØ¯:</label>
          <input type="password" id="newPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¬Ø¯ÛŒØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" onkeyup="checkPasswordStrength()">
          <div class="password-strength"><div class="password-strength-meter" id="passwordStrength"></div></div>
        </div>
        <div class="form-group">
          <label for="confirmPassword">ØªÚ©Ø±Ø§Ø± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¬Ø¯ÛŒØ¯:</label>
          <input type="password" id="confirmPassword" placeholder="Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¬Ø¯ÛŒØ¯ Ø±Ø§ ØªÚ©Ø±Ø§Ø± Ú©Ù†ÛŒØ¯">
        </div>
        <button class="btn btn-secondary" onclick="changePassword()">ğŸ”’ ØªØºÛŒÛŒØ± Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</button>
        <p class="hint">ÛŒÙˆØ²Ø±Ù†ÛŒÙ… Ù¾ÛŒØ´â€ŒÙØ±Ø¶: <b>582441387shayan878</b> â€” Ø±Ù…Ø² ÙØ¹Ù„ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶: <b>sh878</b></p>
      </div>

      <!-- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ (Gist) -->
      <div class="card" style="grid-column:1 / -1">
        <h2 class="card-title"><span>â˜ï¸</span> ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²ÛŒ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ (Ø¨Ø¯ÙˆÙ† Ø±ÛŒÙ¾ÙˆØ²ÛŒØªÙˆØ±ÛŒ)</h2>

        <div class="form-group">
          <label for="gistId">Gist ID (Ø¹Ù…ÙˆÙ…ÛŒ):</label>
          <input type="text" id="gistId" placeholder="Ù…Ø«Ø§Ù„: a1b2c3d4e5f6g7h8i9">
          <p class="hint">ÛŒÚ© Gist Ø¹Ù…ÙˆÙ…ÛŒ Ø¨Ø³Ø§Ø² Ùˆ ÙÙ‚Ø· <b>ID</b> Ø±Ùˆ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ø°Ø§Ø±. Ù…Ø­ØªÙˆØ§ÛŒ ÙØ§ÛŒÙ„ Ù¾Ù†Ù„â€ŒÙ‡Ø§ Ø¯Ø§Ø®Ù„ <b>panels.json</b> Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>
        </div>

        <div class="row">
          <div class="form-group">
            <label for="gistFile">Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø¯Ø§Ø®Ù„ Gist:</label>
            <input type="text" id="gistFile" value="panels.json">
          </div>
          <div class="form-group">
            <label for="ghToken">GitHub Token (Ø§Ø®ØªÛŒØ§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø¯Ù†ØŒ Ù„Ø§Ø²Ù… Ø¨Ø±Ø§ÛŒ Ù†ÙˆØ´ØªÙ†):</label>
            <input type="password" id="ghToken" placeholder="ghp_..." autocomplete="off">
          </div>
        </div>

        <div class="panel-actions">
          <button class="btn" onclick="saveSettings()">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª</button>
          <button class="btn btn-secondary" onclick="pullFromGitHub()">â¬‡ï¸ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø² Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨</button>
          <button class="btn" onclick="pushToGitHub()">â¬†ï¸ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨</button>
        </div>

        <div class="form-group">
          <label for="shareInput">Ù„ÛŒÙ†Ú© Ø§Ø´ØªØ±Ø§Ú© Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ø´Ù†Ø§Ø³:</label>
          <input type="text" id="shareInput" readonly>
          <p class="hint">Ø§ÛŒÙ† Ù„ÛŒÙ†Ú© Ø±Ùˆ Ø¨Ù‡ Ù‡Ø± Ú©Ø³ÛŒ Ø¨Ø¯ÛŒØŒ ØµÙØ­Ù‡Ù” Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡â€ŒØµÙˆØ±Øª Ø²Ù†Ø¯Ù‡ Ø§Ø² Ù‡Ù…ÛŒÙ† Gist Ù…ÛŒâ€ŒØ®ÙˆÙ†Ù‡.</p>
        </div>
      </div>
    </div>

    <div class="panel-list" id="panelList"></div>

    <footer><p>Â© 2023 Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù„Ú©Ø³ÛŒÙˆÙ† | Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø¨Ø§ â¤ï¸ ØªÙˆØ³Ø· ØªÛŒÙ… ØªÙˆØ³Ø¹Ù‡</p></footer>
  </div>

  <div class="notification" id="notification"></div>

  <script>
    // --- Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª Ø§Ø¯Ù…ÛŒÙ† (Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø¬Ø¯ÛŒØ¯)
    let adminCredentials = JSON.parse(localStorage.getItem('adminCredentials')) || {
      username: '582441387shayan878',
      password: 'sh878'
    };

    // --- Ù„ÛŒØ³Øª Ù¾Ù†Ù„â€ŒÙ‡Ø§
    let panels = JSON.parse(localStorage.getItem('panels') || '[]');

    // --- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Gist
    let ghSettings = Object.assign({
      gistId: '',
      gistFile: 'panels.json',
      ghToken: '' // Ø¯Ø± localStorage Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ (Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡ Ø´Ø®ØµÛŒ OK)
    }, JSON.parse(localStorage.getItem('ghSettings') || '{}'));

    // Ù†Ù…Ø§ÛŒØ´ Ù„ÛŒÙ†Ú© Ø§Ø´ØªØ±Ø§Ú©
    function refreshShareLink() {
      const share = document.getElementById('shareInput');
      const file = ghSettings.gistFile || 'panels.json';
      const base = location.origin + location.pathname.replace(/admin\.html$/i, 'user.html');
      const link = `${base}?gist=${encodeURIComponent(ghSettings.gistId)}&file=${encodeURIComponent(file)}`;
      share.value = ghSettings.gistId ? link : 'Ø§ÙˆÙ„ Gist ID Ø±Ø§ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯';
    }

    // Ø°Ø®ÛŒØ±Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
    function saveSettings() {
      ghSettings.gistId = document.getElementById('gistId').value.trim();
      ghSettings.gistFile = document.getElementById('gistFile').value.trim() || 'panels.json';
      ghSettings.ghToken = document.getElementById('ghToken').value.trim();
      localStorage.setItem('ghSettings', JSON.stringify(ghSettings));
      refreshShareLink();
      showNotification('ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯', 'success');
    }

    // Ù¾Ø± Ú©Ø±Ø¯Ù† ÙØ±Ù… ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø² Ø­Ø§ÙØ¸Ù‡
    function fillSettingsForm() {
      document.getElementById('gistId').value = ghSettings.gistId || '';
      document.getElementById('gistFile').value = ghSettings.gistFile || 'panels.json';
      document.getElementById('ghToken').value = ghSettings.ghToken || '';
      refreshShareLink();
    }

    // Ø°Ø®ÛŒØ±Ù‡ Ùˆ Ø±Ù†Ø¯Ø± Ù¾Ù†Ù„â€ŒÙ‡Ø§ Ù„ÙˆÚ©Ø§Ù„
    function savePanels() {
      localStorage.setItem('panels', JSON.stringify(panels));
      renderPanels();
    }

    // Ø§ÙØ²ÙˆØ¯Ù† Ù¾Ù†Ù„
    async function addPanel() {
      const title = document.getElementById('title').value.trim();
      const description = document.getElementById('description').value.trim();
      const file = document.getElementById('file').value.trim();

      if (!title || !file) {
        showNotification('Ù„Ø·ÙØ§Ù‹ Ø¹Ù†ÙˆØ§Ù† Ùˆ Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'error');
        return;
      }

      panels.push({ title, description, file });
      savePanels();
      document.getElementById('title').value = '';
      document.getElementById('description').value = '';
      document.getElementById('file').value = '';
      showNotification('Ù¾Ù†Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯', 'success');

      // Ø³ÛŒÙ†Ú© Ø®ÙˆØ¯Ú©Ø§Ø±
      await pushToGitHub();
    }

    // Ø±Ù†Ø¯Ø± Ù¾Ù†Ù„â€ŒÙ‡Ø§
    function renderPanels() {
      const list = document.getElementById('panelList');
      list.innerHTML = '';

      if (panels.length === 0) {
        list.innerHTML = '<p style="text-align: center; color: #808080; padding: 30px;">Ù‡ÛŒÚ† Ù¾Ù†Ù„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯. Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ù¾Ù†Ù„ Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯.</p>';
        return;
      }

      panels.forEach((panel, index) => {
        const div = document.createElement('div');
        div.className = 'panel-item';
        div.innerHTML = `
          <h3>${panel.title}</h3>
          <p>${panel.description || ''}</p>
          <p class="file-info">ğŸ“‚ ÙØ§ÛŒÙ„: ${panel.file}</p>
          <div class="panel-actions">
            <button class="btn btn-secondary" onclick="editPanel(${index})"><span>âœï¸</span> ÙˆÛŒØ±Ø§ÛŒØ´</button>
            <button class="btn btn-danger" onclick="deletePanel(${index})"><span>ğŸ—‘ï¸</span> Ø­Ø°Ù</button>
          </div>
        `;
        list.appendChild(div);
      });
    }

    // Ø­Ø°Ù Ù¾Ù†Ù„
    async function deletePanel(index) {
      if (confirm('Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø§ÛŒÙ† Ù¾Ù†Ù„ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ')) {
        panels.splice(index, 1);
        savePanels();
        showNotification('Ù¾Ù†Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯', 'success');
        await pushToGitHub();
      }
    }

    // ÙˆÛŒØ±Ø§ÛŒØ´ Ù¾Ù†Ù„
    async function editPanel(index) {
      const panel = panels[index];
      const newTitle = prompt('Ø¹Ù†ÙˆØ§Ù† Ø¬Ø¯ÛŒØ¯:', panel.title);
      const newDescription = prompt('ØªÙˆØ¶ÛŒØ­Ø§Øª Ø¬Ø¯ÛŒØ¯:', panel.description || '');
      const newFile = prompt('Ù†Ø§Ù… ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯:', panel.file);

      if (newTitle && newFile) {
        panels[index] = { title: newTitle.trim(), description: (newDescription||'').trim(), file: newFile.trim() };
        savePanels();
        showNotification('Ù¾Ù†Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯', 'success');
        await pushToGitHub();
      }
    }

    // ØªØºÛŒÛŒØ± Ù¾Ø³ÙˆØ±Ø¯
    function changePassword() {
      const currentPassword = document.getElementById('currentPassword').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;

      if (currentPassword !== adminCredentials.password) {
        showNotification('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± ÙØ¹Ù„ÛŒ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª', 'error'); return;
      }
      if (newPassword.length < 6) {
        showNotification('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¬Ø¯ÛŒØ¯ Ø¨Ø§ÛŒØ¯ Ø­Ø¯Ø§Ù‚Ù„ 6 Ú©Ø§Ø±Ø§Ú©ØªØ± Ø¨Ø§Ø´Ø¯', 'error'); return;
      }
      if (newPassword !== confirmPassword) {
        showNotification('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¬Ø¯ÛŒØ¯ Ùˆ ØªÚ©Ø±Ø§Ø± Ø¢Ù† ÛŒÚ©Ø³Ø§Ù† Ù†ÛŒØ³ØªÙ†Ø¯', 'error'); return;
      }
      adminCredentials.password = newPassword;
      localStorage.setItem('adminCredentials', JSON.stringify(adminCredentials));
      document.getElementById('currentPassword').value = '';
      document.getElementById('newPassword').value = '';
      document.getElementById('confirmPassword').value = '';
      document.getElementById('passwordStrength').className = 'password-strength-meter';
      showNotification('Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯', 'success');
    }

    // Ù‚Ø¯Ø±Øª Ù¾Ø³ÙˆØ±Ø¯
    function checkPasswordStrength() {
      const password = document.getElementById('newPassword').value;
      const meter = document.getElementById('passwordStrength');
      if (!password) { meter.className = 'password-strength-meter'; return; }
      if (password.length < 6) meter.className = 'password-strength-meter weak';
      else if (password.length < 10) meter.className = 'password-strength-meter medium';
      else meter.className = 'password-strength-meter strong';
    }

    // Ø§Ø¹Ù„Ø§Ù†
    function showNotification(message, type) {
      const n = document.getElementById('notification');
      n.textContent = message;
      n.className = `notification ${type}`;
      n.classList.add('show');
      setTimeout(()=>n.classList.remove('show'), 3000);
    }

    // --- Ø§Ø¨Ø²Ø§Ø±Ú©â€ŒÙ‡Ø§ÛŒ GitHub Gist
    async function pullFromGitHub() {
      if (!ghSettings.gistId) { showNotification('Ø§Ø¨ØªØ¯Ø§ Gist ID Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯', 'error'); return; }
      try {
        const res = await fetch(`https://api.github.com/gists/${ghSettings.gistId}`, {
          headers: ghSettings.ghToken ? { Authorization: `Bearer ${ghSettings.ghToken}` } : {}
        });
        if (!res.ok) throw new Error('Gist not found');
        const data = await res.json();
        const fileName = ghSettings.gistFile || 'panels.json';
        const file = data.files && data.files[fileName];
        if (!file) throw new Error(`ÙØ§ÛŒÙ„ ${fileName} Ø¯Ø± Gist Ù†ÛŒØ³Øª`);
        panels = JSON.parse(file.content || '[]');
        savePanels();
        showNotification('Ø¯Ø±ÛŒØ§ÙØª Ø§Ø² Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'success');
      } catch (e) {
        showNotification('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø² Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨: ' + e.message, 'error');
      }
    }

    async function pushToGitHub() {
      if (!ghSettings.gistId) { showNotification('Ø§Ø¨ØªØ¯Ø§ Gist ID Ø±Ø§ ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ÛŒØ¯', 'error'); return; }
      if (!ghSettings.ghToken) { showNotification('Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ GistØŒ ØªÙˆÚ©Ù† Ù„Ø§Ø²Ù… Ø§Ø³Øª', 'error'); return; }
      try {
        const body = {
          files: {
            [ghSettings.gistFile || 'panels.json']: {
              content: JSON.stringify(panels, null, 2)
            }
          }
        };
        const res = await fetch(`https://api.github.com/gists/${ghSettings.gistId}`, {
          method: 'PATCH',
          headers: {
            'Content-Type': 'application/json',
            Accept: 'application/vnd.github+json',
            Authorization: `Bearer ${ghSettings.ghToken}`
          },
          body: JSON.stringify(body)
        });
        if (!res.ok) throw new Error('Ø§Ø±Ø³Ø§Ù„ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨ÙˆØ¯');
        showNotification('Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'success');
      } catch (e) {
        showNotification('Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú¯ÛŒØªâ€ŒÙ‡Ø§Ø¨: ' + e.message, 'error');
      }
    }

    // Ø±Ù†Ø¯Ø± Ø§ÙˆÙ„ÛŒÙ‡
    fillSettingsForm();
    renderPanels();
    // Ø§Ú¯Ø± Gist ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯Ù‡ØŒ Ø¯Ø± Ø´Ø±ÙˆØ¹ ØªÙ„Ø§Ø´ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ø§Ø² Ø¢Ù† Ø¨Ú©Ø´ÛŒÙ…
    if (ghSettings.gistId) { pullFromGitHub(); }
  </script>
</body>
            </html>
